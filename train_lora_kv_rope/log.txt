W1204 09:14:24.238000 1118024 site-packages/torch/distributed/run.py:803] 
W1204 09:14:24.238000 1118024 site-packages/torch/distributed/run.py:803] *****************************************
W1204 09:14:24.238000 1118024 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1204 09:14:24.238000 1118024 site-packages/torch/distributed/run.py:803] *****************************************
Multiple distributions found for package optimum. Picked distribution: optimum-quanto
Multiple distributions found for package optimum. Picked distribution: optimum-quanto
Multiple distributions found for package optimum. Picked distribution: optimum-quanto
Multiple distributions found for package optimum. Picked distribution: optimum-quanto
Multiple distributions found for package optimum. Picked distribution: optimum-quanto
Multiple distributions found for package optimum. Picked distribution: optimum-quanto
12/04/2025 09:14:32 - INFO - __main__ - Distributed environment: DistributedType.DEEPSPEED  Backend: nccl
Num processes: 6
Process index: 2
Local process index: 2
Device: cuda:2

Mixed precision type: bf16
ds_config: {'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'gradient_accumulation_steps': 1, 'zero_optimization': {'stage': 3, 'offload_optimizer': {'device': 'cpu', 'nvme_path': None}, 'offload_param': {'device': 'cpu', 'nvme_path': None}, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'bf16': {'enabled': True}, 'fp16': {'enabled': False}}

12/04/2025 09:14:32 - INFO - __main__ - Distributed environment: DistributedType.DEEPSPEED  Backend: nccl
Num processes: 6
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16
ds_config: {'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'gradient_accumulation_steps': 1, 'zero_optimization': {'stage': 3, 'offload_optimizer': {'device': 'cpu', 'nvme_path': None}, 'offload_param': {'device': 'cpu', 'nvme_path': None}, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'bf16': {'enabled': True}, 'fp16': {'enabled': False}}

12/04/2025 09:14:32 - INFO - __main__ - Distributed environment: DistributedType.DEEPSPEED  Backend: nccl
Num processes: 6
Process index: 3
Local process index: 3
Device: cuda:3

Mixed precision type: bf16
ds_config: {'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'gradient_accumulation_steps': 1, 'zero_optimization': {'stage': 3, 'offload_optimizer': {'device': 'cpu', 'nvme_path': None}, 'offload_param': {'device': 'cpu', 'nvme_path': None}, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'bf16': {'enabled': True}, 'fp16': {'enabled': False}}

12/04/2025 09:14:32 - INFO - __main__ - Distributed environment: DistributedType.DEEPSPEED  Backend: nccl
Num processes: 6
Process index: 5
Local process index: 5
Device: cuda:5

Mixed precision type: bf16
ds_config: {'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'gradient_accumulation_steps': 1, 'zero_optimization': {'stage': 3, 'offload_optimizer': {'device': 'cpu', 'nvme_path': None}, 'offload_param': {'device': 'cpu', 'nvme_path': None}, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'bf16': {'enabled': True}, 'fp16': {'enabled': False}}

12/04/2025 09:14:32 - INFO - __main__ - Distributed environment: DistributedType.DEEPSPEED  Backend: nccl
Num processes: 6
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: bf16
ds_config: {'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'gradient_accumulation_steps': 1, 'zero_optimization': {'stage': 3, 'offload_optimizer': {'device': 'cpu', 'nvme_path': None}, 'offload_param': {'device': 'cpu', 'nvme_path': None}, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'bf16': {'enabled': True}, 'fp16': {'enabled': False}}

12/04/2025 09:14:32 - INFO - __main__ - Distributed environment: DistributedType.DEEPSPEED  Backend: nccl
Num processes: 6
Process index: 4
Local process index: 4
Device: cuda:4

Mixed precision type: bf16
ds_config: {'train_batch_size': 'auto', 'train_micro_batch_size_per_gpu': 'auto', 'gradient_accumulation_steps': 1, 'zero_optimization': {'stage': 3, 'offload_optimizer': {'device': 'cpu', 'nvme_path': None}, 'offload_param': {'device': 'cpu', 'nvme_path': None}, 'stage3_gather_16bit_weights_on_model_save': True}, 'gradient_clipping': 'auto', 'steps_per_print': inf, 'bf16': {'enabled': True}, 'fp16': {'enabled': False}}

All model checkpoint weights were used when initializing AutoencoderKLQwenImage.

All the weights of AutoencoderKLQwenImage were initialized from the model checkpoint at /app/cold1/Qwen-Image-Edit-2509.
If your task is similar to the task the model of the checkpoint was trained on, you can already use AutoencoderKLQwenImage for predictions without further training.
Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]`torch_dtype` is deprecated! Use `dtype` instead!
Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [00:00<00:01,  2.57it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:50<02:31, 50.66s/it][A


Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:50<02:31, 50.66s/it][ALoading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:50<02:31, 50.66s/it][ALoading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:50<02:31, 50.66s/it][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:50<02:31, 50.66s/it][A
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:50<02:32, 50.77s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [01:36<01:35, 47.81s/it][A


Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [01:36<01:35, 47.81s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [01:36<01:35, 47.81s/it][A[ALoading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [01:36<01:35, 47.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [01:36<01:35, 47.81s/it][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [01:36<01:35, 47.85s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [02:19<00:45, 45.77s/it][A



Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [02:19<00:45, 45.77s/it][ALoading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [02:19<00:45, 45.78s/it][ALoading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [02:19<00:45, 45.77s/it][ALoading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [02:19<00:45, 45.78s/it][A
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [02:19<00:45, 45.79s/it][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 33.57s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 38.67s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 33.57s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 38.67s/it]
Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [02:37<10:31, 157.95s/it]Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [02:37<10:31, 157.95s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 33.56s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 38.68s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 33.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 38.68s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 33.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 38.68s/it]
Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [02:37<10:31, 157.98s/it]Loaded text_encoder as Qwen2_5_VLForConditionalGeneration from `text_encoder` subfolder of /app/cold1/Qwen-Image-Edit-2509.
Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [02:37<10:31, 157.98s/it]Loading pipeline components...:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [02:37<04:38, 92.87s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 33.59s/it][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [02:34<00:00, 38.68s/it]
Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [02:37<10:31, 158.00s/it]Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:29, 29.93s/it] Loading pipeline components...:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:38<01:22, 41.30s/it] Loaded processor as Qwen2VLProcessor from `processor` subfolder of /app/cold1/Qwen-Image-Edit-2509.
Loading pipeline components...:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [02:38<03:16, 65.64s/it] Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:34, 34.95s/it]Loading pipeline components...:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [02:38<03:16, 65.64s/it] Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:38<00:00, 31.80s/it]
ðŸ”¥å¼€å§‹çƒ­æ’æ‹” Attention Processors for Style Control...
âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ° transformer.transformer_blocksã€‚çƒ­æ’æ‹”å¤±è´¥ã€‚
âœ… çƒ­æ’æ‹”å®Œæˆï¼
Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:30, 30.16s/it] Loaded scheduler as FlowMatchEulerDiscreteScheduler from `scheduler` subfolder of /app/cold1/Qwen-Image-Edit-2509.
Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:38<00:00, 31.80s/it]
ðŸ”¥å¼€å§‹çƒ­æ’æ‹” Attention Processors for Style Control...
âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ° transformer.transformer_blocksã€‚çƒ­æ’æ‹”å¤±è´¥ã€‚
âœ… çƒ­æ’æ‹”å®Œæˆï¼
Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:27, 27.07s/it]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:39<00:00, 31.81s/it]
ðŸ”¥å¼€å§‹çƒ­æ’æ‹” Attention Processors for Style Control...
âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ° transformer.transformer_blocksã€‚çƒ­æ’æ‹”å¤±è´¥ã€‚
âœ… çƒ­æ’æ‹”å®Œæˆï¼
Loaded tokenizer as Qwen2Tokenizer from `tokenizer` subfolder of /app/cold1/Qwen-Image-Edit-2509.
Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:39<00:00, 18.68s/it]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:39<00:00, 21.81s/it]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:39<00:00, 31.83s/it]
Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:39<00:00, 31.83s/it]
Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:24, 24.54s/it]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:39<00:00, 31.83s/it]
ðŸ”¥å¼€å§‹çƒ­æ’æ‹” Attention Processors for Style Control...
ðŸ”¥å¼€å§‹çƒ­æ’æ‹” Attention Processors for Style Control...âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ° transformer.transformer_blocksã€‚çƒ­æ’æ‹”å¤±è´¥ã€‚

âœ… çƒ­æ’æ‹”å®Œæˆï¼
âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ° transformer.transformer_blocksã€‚çƒ­æ’æ‹”å¤±è´¥ã€‚
âœ… çƒ­æ’æ‹”å®Œæˆï¼
ðŸ”¥å¼€å§‹çƒ­æ’æ‹” Attention Processors for Style Control...
âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ° transformer.transformer_blocksã€‚çƒ­æ’æ‹”å¤±è´¥ã€‚
âœ… çƒ­æ’æ‹”å®Œæˆï¼
Finished setting up embeddings cache paths.
Finished setting up embeddings cache paths.
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Finished setting up embeddings cache paths.
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Finished setting up embeddings cache paths.
Finished setting up embeddings cache paths.
Finished setting up embeddings cache paths.
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:47<07:10, 107.56s/it]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:49<07:17, 109.29s/it]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:49<07:16, 109.11s/it]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:49<07:16, 109.11s/it]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:49<07:16, 109.23s/it]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [01:49<07:16, 109.11s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:44<05:38, 112.81s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:46<05:42, 114.23s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:46<05:41, 113.85s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:46<05:41, 113.93s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:46<05:41, 113.90s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [03:46<05:41, 113.85s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [05:40<03:48, 114.24s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [05:42<03:49, 114.76s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [05:42<03:49, 114.74s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [05:42<03:49, 114.73s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [05:42<03:49, 114.94s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [05:42<03:49, 114.78s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [06:04<01:18, 78.81s/it] Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [06:05<01:18, 78.51s/it] Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [06:05<01:18, 78.66s/it] Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [06:05<01:18, 78.89s/it] Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [06:05<01:18, 78.80s/it] Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [06:05<01:18, 78.83s/it] Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 54.35s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 75.34s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 54.61s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 75.33s/it]
All model checkpoint weights were used when initializing QwenImageTransformer2DModel.

All the weights of QwenImageTransformer2DModel were initialized from the model checkpoint at /app/cold1/Qwen-Image-Edit-2509.
If your task is similar to the task the model of the checkpoint was trained on, you can already use QwenImageTransformer2DModel for predictions without further training.
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 54.35s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 54.41s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 54.30s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 54.32s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 75.33s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 75.37s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 75.35s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:16<00:00, 75.33s/it]
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

========================================
Total Trainable Parameters (LoRA + Style KV): 47.5546 M
========================================

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
cache_dirs: txt: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/text_embs, img: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs, control: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs_control
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

========================================
Total Trainable Parameters (LoRA + Style KV): 47.5546 M
========================================

111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl

========================================
Total Trainable Parameters (LoRA + Style KV): 47.5546 M
========================================


========================================
Total Trainable Parameters (LoRA + Style KV): 47.5546 M
========================================


========================================
Total Trainable Parameters (LoRA + Style KV): 47.5546 M
========================================

cache_dirs: txt: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/text_embs, img: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs, control: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs_control
111Initialized QwenDoubleStreamAttnProcessor2_0WithStyleControl
cache_dirs: txt: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/text_embs, img: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs, control: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs_control
cache_dirs: txt: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/text_embs, img: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs, control: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs_control
cache_dirs: txt: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/text_embs, img: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs, control: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs_control

========================================
Total Trainable Parameters (LoRA + Style KV): 47.5546 M
========================================

cache_dirs: txt: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/text_embs, img: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs, control: /app/cold1/code/texteditRoPE/qwenimage-style-rope-lora-large-scale/cache/img_embs_control
Parameter Offload - Persistent parameters statistics: param_count = 1747, numel = 29544060
wandb: Currently logged in as: 1491456253 to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run oob7fgmh
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /app/cold1/code/texteditRoPE/train_lora_kv_rope/wandb/run-20251204_092507-oob7fgmh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-cosmos-7
wandb: â­ï¸ View project at https://wandb.ai/1491456253/style-edit-qwen-test-rope-lora-large-scale
wandb: ðŸš€ View run at https://wandb.ai/1491456253/style-edit-qwen-test-rope-lora-large-scale/runs/oob7fgmh
12/04/2025 09:25:09 - INFO - __main__ - Total train batch size = 12
Steps:   0%|          | 0/300000 [00:00<?, ?it/s]ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: unable to write to file </torch_1162618_4228649714_0>: No space left on device (28)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: unable to write to file </torch_1162628_3919411366_0>: No space left on device (28)
ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: unable to write to file </torch_1162621_157237468_0>: No space left on device (28)
[rank5]: Traceback (most recent call last):
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1275, in _try_get_data
[rank5]:     data = self._data_queue.get(timeout=timeout)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 113, in get
[rank5]:     if not self._poll(timeout):
[rank5]:            ^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 257, in poll
[rank5]:     return self._poll(timeout)
[rank5]:            ^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 440, in _poll
[rank5]:     r = wait([self], timeout)
[rank5]:         ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 1136, in wait
[rank5]:     ready = selector.select(timeout)
[rank5]:             ^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/selectors.py", line 415, in select
[rank5]:     fd_event_list = self._selector.poll(timeout)
[rank5]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
[rank5]:     _error_if_any_worker_fails()
[rank5]: RuntimeError: DataLoader worker (pid 1162636) is killed by signal: Bus error. It is possible that dataloader's workers are out of shared memory. Please try to raise your shared memory limit.

[rank5]: The above exception was the direct cause of the following exception:

[rank5]: Traceback (most recent call last):
[rank5]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 644, in <module>
[rank5]:     main()
[rank5]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 456, in main
[rank5]:     for step, batch in enumerate(train_dataloader):
[rank5]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/data_loader.py", line 567, in __iter__
[rank5]:     current_batch = next(dataloader_iter)
[rank5]:                     ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
[rank5]:     data = self._next_data()
[rank5]:            ^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1482, in _next_data
[rank5]:     idx, data = self._get_data()
[rank5]:                 ^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1444, in _get_data
[rank5]:     success, data = self._try_get_data()
[rank5]:                     ^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1288, in _try_get_data
[rank5]:     raise RuntimeError(
[rank5]: RuntimeError: DataLoader worker (pid(s) 1162636) exited unexpectedly
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: unable to write to file </torch_1162623_4061353035_0>: No space left on device (28)
ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 [rank3]: Traceback (most recent call last):
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1275, in _try_get_data
[rank3]:     data = self._data_queue.get(timeout=timeout)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 113, in get
[rank3]:     if not self._poll(timeout):
[rank3]:            ^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 257, in poll
[rank3]:     return self._poll(timeout)
[rank3]:            ^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 440, in _poll
[rank3]:     r = wait([self], timeout)
[rank3]:         ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 1136, in wait
[rank3]:     ready = selector.select(timeout)
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/selectors.py", line 415, in select
[rank3]:     fd_event_list = self._selector.poll(timeout)
[rank3]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
[rank3]:     _error_if_any_worker_fails()
[rank3]: RuntimeError: DataLoader worker (pid 1162620) is killed by signal: Bus error. It is possible that dataloader's workers are out of shared memory. Please try to raise your shared memory limit.

[rank3]: The above exception was the direct cause of the following exception:

[rank3]: Traceback (most recent call last):
[rank3]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 644, in <module>
[rank3]:     main()
[rank3]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 456, in main
[rank3]:     for step, batch in enumerate(train_dataloader):
[rank3]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/data_loader.py", line 567, in __iter__
[rank3]:     current_batch = next(dataloader_iter)
[rank3]:                     ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
[rank3]:     data = self._next_data()
[rank3]:            ^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1482, in _next_data
[rank3]:     idx, data = self._get_data()
[rank3]:                 ^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1444, in _get_data
[rank3]:     success, data = self._try_get_data()
[rank3]:                     ^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1288, in _try_get_data
[rank3]:     raise RuntimeError(
[rank3]: RuntimeError: DataLoader worker (pid(s) 1162620) exited unexpectedly
[rank4]: Traceback (most recent call last):
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1275, in _try_get_data
[rank4]:     data = self._data_queue.get(timeout=timeout)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 113, in get
[rank4]:     if not self._poll(timeout):
[rank4]:            ^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 257, in poll
[rank4]:     return self._poll(timeout)
[rank4]:            ^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 440, in _poll
[rank4]:     r = wait([self], timeout)
[rank4]:         ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 1136, in wait
[rank4]:     ready = selector.select(timeout)
[rank4]:             ^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/selectors.py", line 415, in select
[rank4]:     fd_event_list = self._selector.poll(timeout)
[rank4]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
[rank4]:     _error_if_any_worker_fails()
[rank4]: RuntimeError: DataLoader worker (pid 1162629) is killed by signal: Bus error. It is possible that dataloader's workers are out of shared memory. Please try to raise your shared memory limit.

[rank4]: The above exception was the direct cause of the following exception:

[rank4]: Traceback (most recent call last):
[rank4]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 644, in <module>
[rank4]:     main()
[rank4]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 456, in main
[rank4]:     for step, batch in enumerate(train_dataloader):
[rank4]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/data_loader.py", line 567, in __iter__
[rank4]:     current_batch = next(dataloader_iter)
[rank4]:                     ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
[rank4]:     data = self._next_data()
[rank4]:            ^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1482, in _next_data
[rank4]:     idx, data = self._get_data()
[rank4]:                 ^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1444, in _get_data
[rank4]:     success, data = self._try_get_data()
[rank4]:                     ^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1288, in _try_get_data
[rank4]:     raise RuntimeError(
[rank4]: RuntimeError: DataLoader worker (pid(s) 1162629) exited unexpectedly
Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: unable to write to file </torch_1162624_2496589566_1>: No space left on device (28)
Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
RuntimeError: unable to write to file </torch_1162619_795321594_0>: No space left on device (28)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
    fd, size = storage._share_fd_cpu_()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
    return super()._share_fd_cpu_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: unable to write to file </torch_1162639_1301833432_0>: No space left on device (28)
[rank2]: Traceback (most recent call last):
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1275, in _try_get_data
[rank2]:     data = self._data_queue.get(timeout=timeout)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/queues.py", line 113, in get
[rank2]:     if not self._poll(timeout):
[rank2]:            ^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 257, in poll
[rank2]:     return self._poll(timeout)
[rank2]:            ^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 440, in _poll
[rank2]:     r = wait([self], timeout)
[rank2]:         ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/multiprocessing/connection.py", line 1136, in wait
[rank2]:     ready = selector.select(timeout)
[rank2]:             ^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/selectors.py", line 415, in select
[rank2]:     fd_event_list = self._selector.poll(timeout)
[rank2]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
[rank2]:     _error_if_any_worker_fails()
[rank2]: RuntimeError: DataLoader worker (pid 1162627) is killed by signal: Bus error. It is possible that dataloader's workers are out of shared memory. Please try to raise your shared memory limit.

[rank2]: The above exception was the direct cause of the following exception:

[rank2]: Traceback (most recent call last):
[rank2]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 644, in <module>
[rank2]:     main()
[rank2]:   File "/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py", line 456, in main
[rank2]:     for step, batch in enumerate(train_dataloader):
[rank2]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/data_loader.py", line 567, in __iter__
[rank2]:     current_batch = next(dataloader_iter)
[rank2]:                     ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
[rank2]:     data = self._next_data()
[rank2]:            ^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1482, in _next_data
[rank2]:     idx, data = self._get_data()
[rank2]:                 ^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1444, in _get_data
[rank2]:     success, data = self._try_get_data()
[rank2]:                     ^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1288, in _try_get_data
[rank2]:     raise RuntimeError(
[rank2]: RuntimeError: DataLoader worker (pid(s) 1162627) exited unexpectedly
ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).
 W1204 09:25:22.283000 1118024 site-packages/torch/distributed/elastic/multiprocessing/api.py:908] Sending process 1118542 closing signal SIGTERM
W1204 09:25:22.284000 1118024 site-packages/torch/distributed/elastic/multiprocessing/api.py:908] Sending process 1118543 closing signal SIGTERM
W1204 09:25:22.285000 1118024 site-packages/torch/distributed/elastic/multiprocessing/api.py:908] Sending process 1118544 closing signal SIGTERM
W1204 09:25:22.286000 1118024 site-packages/torch/distributed/elastic/multiprocessing/api.py:908] Sending process 1118545 closing signal SIGTERM
W1204 09:25:22.286000 1118024 site-packages/torch/distributed/elastic/multiprocessing/api.py:908] Sending process 1118547 closing signal SIGTERM
E1204 09:25:23.116000 1118024 site-packages/torch/distributed/elastic/multiprocessing/api.py:882] failed (exitcode: 1) local_rank: 4 (pid: 1118546) of binary: /root/miniconda3/envs/qwenimage/bin/python3.12
Traceback (most recent call last):
  File "/root/miniconda3/envs/qwenimage/bin/accelerate", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/commands/accelerate_cli.py", line 50, in main
    args.func(args)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/commands/launch.py", line 1220, in launch_command
    deepspeed_launcher(args)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/accelerate/commands/launch.py", line 906, in deepspeed_launcher
    distrib_run.run(args)
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/distributed/run.py", line 927, in run
    elastic_launch(
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 156, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/qwenimage/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 293, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/app/cold1/code/texteditRoPE/train_lora_kv_rope/train_qwen_lora_kv.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-04_09:25:22
  host      : 8fa0fe18ec1f
  rank      : 4 (local_rank: 4)
  exitcode  : 1 (pid: 1118546)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
